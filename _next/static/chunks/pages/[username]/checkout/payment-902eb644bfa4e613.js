(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2841],{86001:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var r=a(67294),n=a(11163),o=a(95814),i=a(53918),l=a(37541),c=a(43324),s=a(27294),u=a(56418),d=a(1807),C=a(25540),m=a(72144),v=a(3346),S=a(7034),f=a(79389),E=a(5540),p=a(51225);var b=(0,r.forwardRef)(((e,t)=>{const a=(0,u.k)(),{isMobile:n,colors:o}=(0,i.useTheme)(),{actionService:b}=(0,m.Q)(),h=(0,c.CG)((e=>e.cartState.prevCheckoutFlowStage)),{manualEnabled:g,onlineEnabled:O,codEnabled:w,onWalletToggle:_,paymentRestrictions:k,mode:T,isModeEnabled:y,isWalletAvailable:W,isWalletBalanceNonZero:M,useWalletCredits:D,setUp:R,partialCodState:N,onPaymentModeClick:G}=(0,d.V)(),P=(0,c.CG)((e=>e.customerState)),j=(0,c.CG)((e=>e.storeState.store)),F=(0,c.CG)((e=>e.cartState)),{uiCart:I}=(0,c.CG)((e=>e.cartState)),A=new l.yS(j.meta),[H,x]=(0,r.useState)(!1),L=(0,c.TL)(),{validateCart:B}=(0,v.j)(),{formatCurrency:U}=(0,S.U)(),Q=new f.m,V=(0,c.CG)((e=>e.storeState.store.meta));(0,r.useEffect)((()=>{var e;h?(null===(e=null===V||void 0===V?void 0:V.extraConfiguration)||void 0===e?void 0:e.cartValidationOnCheckout)&&B(U,"infoMessage").then((()=>{L(s.W2.setCartLoading(!1)),F.uiCart.promo&&F.uiCart&&(L(E.OQ.setPromoCode(F.uiCart.promoData.promo.code)),Q.applyPromo(F.uiCart))})):b.redirectToCheckout.call(b),L(s.W2.setCartLoading(!0)),R().then().catch()}),[]);const X=async()=>{x(!0),(y(T)||F.uiCart.walletCredits.useWalletCredits&&F.uiCart.walletCredits.availableWalletCredits>F.uiCart.total)&&await a._placeOrder(j,I,A).then((e=>{var t,a;if(e)if((null===(t=I.items)||void 0===t?void 0:t[0].isSubscribable)&&(null===(a=I.items)||void 0===a?void 0:a[0].startDate))L(s.W2.emptyCart({store:j})),b.redirectToSubscriptionOrdersDetails.call(b,e);else{if(L(s.W2.emptyCart({store:j})),null===j||void 0===j?void 0:j.meta.isServiceStore)return void b.redirectToBookingDetails(e);T===p.h.partialCOD||T===p.h.online?b.redirectToOrderStatusPage(e):b.redirectToOrderDetails(e,!0)}}))};return(0,r.useImperativeHandle)(t,(()=>({placeOrder:X}))),r.createElement(C.U,Object.assign({},{isMobile:n,isWalletAvailable:W,isWalletBalanceNonZero:M,useWalletCredits:D,customerState:P,onWalletToggle:_,partialCodState:N,isModeEnabled:y,onClick:G,mode:T,paymentRestrictions:k,store:j,codEnabled:w,manualEnabled:g,onlineEnabled:O,showModal:H,setShowModal:x}))})),h=a(79423),g=a(41486);const O=({actionService:e})=>{const t=r.createRef();return r.createElement(i.StyleSheetManager,{disableCSSOMInjection:!0},r.createElement("div",{id:"dummydiv",onClick:()=>{}},r.createElement(h.L,Object.assign({},{currentStage:g.D.PAYMENTS,next:async()=>{if(console.log("here in placing order",t.current),t.current){const e=t.current;await e.placeOrder()}},actionService:e,summaryFeatures:[]}),r.createElement(b,{ref:t}))))};var w=a(45672),_=a(85893),k=function(){var e=(0,n.useRouter)(),t=o.c.getInstance(e),a=w.M.getInstance(),i=(0,r.useState)(!1),l=i[0],s=i[1],u=(0,c.CG)((function(e){return e.cartState.prevCheckoutFlowStage}));return(0,r.useEffect)((function(){if(u)return s(!0),a.broadcast("HIDE_HEADER_FOOTER",!0),function(){a.broadcast("HIDE_HEADER_FOOTER",!1)};t.redirectToCheckout()}),[]),(0,_.jsx)(_.Fragment,{children:l&&(0,_.jsx)(O,{actionService:t})})}},38098:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[username]/checkout/payment",function(){return a(86001)}])}},function(e){e.O(0,[4864,5362,2063,1199,3346,7502,9423,7541,5113,9774,2888,179],(function(){return t=38098,e(e.s=t);var t}));var t=e.O();_N_E=t}]);